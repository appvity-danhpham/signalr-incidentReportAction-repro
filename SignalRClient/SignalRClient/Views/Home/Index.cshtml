@{
    ViewData["Title"] = "Home Page";
}

<h2>Incident Reports</h2>
<ul id="incidentList"></ul>

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js"></script>
    <script>
        // Create connection
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("https://localhost:7128/incidentHub")
            .build();

        // Listen for 'incidentReportAction'
        connection.on("incidentReportAction", function (data) {
            // Display the received data
            const li = document.createElement("li");
            li.textContent = JSON.stringify(data);
            document.getElementById("incidentList").appendChild(li);
        });

        // Start the connection
        connection.start()
            .then(function () {
                console.log("Connected to SignalR hub.");
            })
            .catch(function (err) {
                return console.error(err.toString());
            });
    </script>
}